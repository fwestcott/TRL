---
title: "TRL"
author: "Felix Westcott"
date: "2024-05-28"
output: html_document
---

```{r setup, include=FALSE}

library(tidyverse)
library(ggplot2)
library(readxl)
library(xlsx)
library(dplyr)
library(ggpubr)
library(ggsci)
library(rstatix)
library(cowplot)
library(ggprism)


```


```{R, Labelled TRL Just Control}

Labelled_Data <- read_excel("TRL all data.xlsx", sheet = 2)

Control_Data <- filter(Labelled_Data, Labelled_Data$Media == "LFLS")

for (i in 8:ncol(Control_Data)) {
   formula <- as.formula(paste("`", colnames(Control_Data)[i], "`", " ~ BAF", sep=""))
   model <- t_test(formula, data = Control_Data)
   
   cat("\n-----\n\n")
   cat(colnames(Control_Data)[i])
   cat("\n")
   print(model)
}

#Actually useful graphs
ggstripchart(Control_Data, "BAF", "TRL disappearance",
       add = c("mean", "mean_sd", "jitter"), color = "BAF", error.plot = "errorbar", palette = "npg", size = 1.2, ylab = "Extracellular 13C 16:0 in TG disappearance \n (%)", ylim = c(0,50), shape = 4) +
   theme_prism(base_size = 14) + 
  rremove("xlab") +
  rremove("legend")
ggsave('C:/Users/fwestcott/OneDrive - Nexus365/Desktop/Outputs/Thesis/figures/ch6-TRL/Control TRL disappearance.png')

ggstripchart(Control_Data, "BAF", "IHCTG conc",
       add = c("mean", "mean_sd", "jitter"), error.plot = "errorbar", palette = "npg", size = 1.2, ylab = "Intracellular 13C 16:0 in TG \n (nmol/g of protein)", ylim = c(0,120), color = "BAF", shape = 4) +
   theme_prism(base_size = 14) + 
  rremove("xlab") +
  rremove("legend")
ggsave('C:/Users/fwestcott/OneDrive - Nexus365/Desktop/Outputs/Thesis/figures/ch6-TRL/Control IHCTG conc.png')

t.test = Control_Data %>%
  t_test(`EHCFA conc` ~ BAF) %>%
  add_significance("p") %>%
  filter(p < 0.1) %>%
  add_xy_position(x = "BAF")

ggstripchart(Control_Data, "BAF", "EHCFA conc",
       add = c("mean", "mean_sd", "jitter"), error.plot = "errorbar", palette = "npg", size = 1.2, ylab = "Extracellular 13C 16:0 \n (nmol/g of protein)", ylim = c(0,150), color = "BAF", shape = 4) +
   theme_prism(base_size = 14) + 
  rremove("xlab") +
  rremove("legend") +
  stat_pvalue_manual(t.test, label = "p", y.position  = 140)
ggsave('C:/Users/fwestcott/OneDrive - Nexus365/Desktop/Outputs/Thesis/figures/ch6-TRL/Control EHCFA conc.png')

ggstripchart(Control_Data, "BAF", "IHCFA conc",
       add = c("mean", "mean_sd", "jitter"), error.plot = "errorbar", palette = "npg", size = 1.2, ylab = "Intracellular 13C 16:0 \n (nmol/g of protein)", ylim = c(0,20), color = "BAF", shape = 4) +
   theme_prism(base_size = 14) + 
  rremove("xlab") +
  rremove("legend")
ggsave('C:/Users/fwestcott/OneDrive - Nexus365/Desktop/Outputs/Thesis/figures/ch6-TRL/Control IHCFA conc.png')


ggstripchart(Control_Data, "BAF", "IHCTG into FAs conc",
       add = c("mean", "mean_sd", "jitter"), error.plot = "errorbar", palette = "npg", size = 1.2, ylab = "Intracellular 13C 16:0 \n (nmol/g of protein)", ylim = c(0,100), color = "BAF", shape = 4) +
   theme_prism(base_size = 14) + 
  rremove("xlab") +
  rremove("legend")

```



```{R, Labelled TRL COP} 

All_Data <- filter(Labelled_Data, Labelled_Data$BAF == "Veh")

for (i in 8:ncol(All_Data)) {
   formula <- as.formula(paste("`", colnames(All_Data)[i], "`", " ~ Media", sep=""))
   model <- aov(formula, data = All_Data)

   cat("\n-----\n\n")
   cat(colnames(All_Data)[i])
   cat("\n")
   print(summary(model))
}

#Actually useful graphs
ggstripchart(All_Data, "Media", "TRL disappearance",
       add = c("mean", "mean_sd", "jitter"), color = "Media", error.plot = "errorbar", palette = "npg", size = 1.2, ylab = "Extracellular 13C 16:0 in TG disappearance \n (%)", ylim = c(0,50), shape = 4) +
   theme_prism(base_size = 14) + 
  rremove("xlab") +
  rremove("legend")
ggsave('C:/Users/fwestcott/OneDrive - Nexus365/Desktop/Outputs/Thesis/figures/ch6-TRL/All TRL disappearance.png')

ggstripchart(All_Data, "Media", "IHCTG conc",
       add = c("mean", "mean_sd", "jitter"), error.plot = "errorbar", palette = "npg", size = 1.2, ylab = "Intracellular 13C 16:0 in TG \n (nmol/g of protein)", ylim = c(0,120), color = "Media", shape = 4) +
   theme_prism(base_size = 14) + 
  rremove("xlab") +
  rremove("legend")
ggsave('C:/Users/fwestcott/OneDrive - Nexus365/Desktop/Outputs/Thesis/figures/ch6-TRL/All IHCTG conc.png')

ggstripchart(All_Data, "Media", "EHCFA conc",
       add = c("mean", "mean_sd", "jitter"), error.plot = "errorbar", palette = "npg", size = 1.2, ylab = "Extracellular 13C 16:0 \n (nmol/g of protein)", ylim = c(0,150), color = "Media", shape = 4) +
   theme_prism(base_size = 14) + 
  rremove("xlab") +
  rremove("legend")
ggsave('C:/Users/fwestcott/OneDrive - Nexus365/Desktop/Outputs/Thesis/figures/ch6-TRL/All EHCFA conc.png')

All_Data <- rename(All_Data, "IHCFA" = "IHCFA conc", "EHCFA" = "EHCFA conc")

pairwise.test = All_Data %>%
 tukey_hsd(IHCFA ~ Media2) %>%
  filter(p.adj < 0.1) %>%
  add_xy_position(x = "Media2")

ggstripchart(All_Data, "Media", "IHCFA",
       add = c("mean", "mean_sd", "jitter"), error.plot = "errorbar", palette = "npg", size = 1.2, ylab = "Intracellular 13C 16:0 \n (nmol/g of protein)", ylim = c(0,20), color = "Media", shape = 4) +
   theme_prism(base_size = 14) + 
  rremove("xlab") +
  rremove("legend") +
  stat_pvalue_manual(pairwise.test[1,], label = "p.adj.signif", y.position  = 17) +
  stat_pvalue_manual(pairwise.test[2,], label = "p.adj", y.position  = 19)
ggsave('C:/Users/fwestcott/OneDrive - Nexus365/Desktop/Outputs/Thesis/figures/ch6-TRL/All IHCFA conc.png')

ggstripchart(All_Data, "Media", "IHCFA TTR",
       add = c("mean", "mean_sd", "jitter"), error.plot = "errorbar", palette = "npg", size = 1.2, ylab = "Intracellular 13C 16:0 \n (nmol/g of protein)", ylim = c(0,0.0005), color = "Media", shape = 4) +
   theme_prism(base_size = 14) + 
  rremove("xlab") +
  rremove("legend") + 
  stat_pvalue_manual(pairwise.test, label = "p.adj.signif", y.position  = 17)

```




```{R, Basal - Inhibited stuff}


Labelled_Basal_Inhibited_Data <- read_excel("TRL all data.xlsx", sheet = 4)

for (i in 8:ncol(Labelled_Basal_Inhibited_Data)) {
   formula <- as.formula(paste("`", colnames(Labelled_Basal_Inhibited_Data)[i], "`", " ~ Media", sep=""))
   model <- aov(formula, data = Labelled_Basal_Inhibited_Data)

   cat("\n-----\n\n")
   cat(colnames(Labelled_Basal_Inhibited_Data)[i])
   cat("\n")
   print(summary(model))
}

ggstripchart(Labelled_Basal_Inhibited_Data, "Media", "Inhibited EHCFA",
       add = c("mean", "mean_sd", "jitter"), error.plot = "errorbar", palette = "npg", size = 1.2, ylab = "Extracellular 13C 16:0 released from  \n non-lipophagic lipolysis (nmol/g of protein)", ylim = c(0,100), color = "Media", shape = 4) +
   theme_prism(base_size = 14) + 
  rremove("xlab") +
  rremove("legend")
ggsave('C:/Users/fwestcott/OneDrive - Nexus365/Desktop/Outputs/Thesis/figures/ch6-TRL/All inhibited EHCFA.png')

ggstripchart(Labelled_Basal_Inhibited_Data, "Media", "Lipophagy EHCFA",
       add = c("mean", "mean_sd", "jitter"), error.plot = "errorbar", palette = "npg", size = 1.2, ylab = "Extracellular 13C 16:0 released from \n lipophagic lipolysis (nmol/g of protein)", ylim = c(0,100), color = "Media", shape = 4) +
   theme_prism(base_size = 14) + 
  rremove("xlab") +
  rremove("legend") 
ggsave('C:/Users/fwestcott/OneDrive - Nexus365/Desktop/Outputs/Thesis/figures/ch6-TRL/All lipophagy EHCFA.png')

ggstripchart(Labelled_Basal_Inhibited_Data, "Media", "Inhibited IHCFA",
       add = c("mean", "mean_sd", "jitter"), error.plot = "errorbar", palette = "npg", size = 1.2, ylab = "Intracellular 13C 16:0 released from \n non-lipophagic lipolysis (nmol/g of protein)", ylim = c(0,10), color = "Media", shape = 4) +
   theme_prism(base_size = 14) + 
  rremove("xlab") +
  rremove("legend")
ggsave('C:/Users/fwestcott/OneDrive - Nexus365/Desktop/Outputs/Thesis/figures/ch6-TRL/All inhibited IHCFA.png')

ggstripchart(Labelled_Basal_Inhibited_Data, "Media", "Lipophagy IHCFA",
       add = c("mean", "mean_sd", "jitter"), error.plot = "errorbar", palette = "npg", size = 1.2, ylab = "Intracellular 13C 16:0 released from \n lipophagic lipolysis (nmol/g of protein)", ylim = c(0,10), color = "Media", shape = 4) +
   theme_prism(base_size = 14) + 
  rremove("xlab") +
  rremove("legend")
ggsave('C:/Users/fwestcott/OneDrive - Nexus365/Desktop/Outputs/Thesis/figures/ch6-TRL/All lipophagy IHCFA.png')

```


```{R, Unlabelled}


Unlabelled_PA_Data <- read_excel("TRL all data.xlsx", sheet = 3)

Unlabelled_PA_Data <- filter(Unlabelled_PA_Data, Unlabelled_PA_Data$BAF == "-")
Unlabelled_PA_Data <- filter(Unlabelled_PA_Data, Unlabelled_PA_Data$TRL == "T")

Unlabelled_PA_Data <- rename(Unlabelled_PA_Data, "IHCFA" = "Intracellular 16:0 (umol/g of protein)")

ggstripchart(Unlabelled_PA_Data, "Media", "IHCFA",
       add = c("mean", "mean_sd", "jitter"), error.plot = "errorbar", palette = "npg", size = 1.2, ylab = "Intracellular 16:0 \n (Umol/g of protein)", ylim = c(0,100), color = "Media", shape = 4) +
   theme_prism(base_size = 14) + 
  rremove("xlab") +
  rremove("legend")



```



